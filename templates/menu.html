{% extends "base.html" %}

{% block title %}Menú Principal{% endblock %}

{% block styles %}
<style>
    /* Estilo para asegurar que las tarjetas en la misma fila tengan la misma altura */
    .card {
        display: flex;
        flex-direction: column;
        height: 100%;
    }
    .card-body {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    .card-body .mt-auto {
        margin-top: auto;
    }
    /* Colores personalizados para botones específicos que ya tenías */
    .btn-pink {
        color: #fff;
        background-color: #d63384;
        border-color: #d63384;
    }
    .btn-purple {
        color: #fff;
        background-color: #6f42c1;
        border-color: #6f42c1;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="text-center mb-5">
        <h1>Menú Principal</h1>
        <p class="lead text-muted">Bienvenido, {{ session.username }}. Selecciona una opción para comenzar.</p>
    </div>

    <div class="row justify-content-center g-4">
        
        <!-- Tarjeta para Crear Plantilla (Solo Admin) -->
        {% if session.role == 'administrador' %}
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-plus-circle-dotted" style="font-size: 3rem; color: #0d6efd;"></i></div>
                    <h5 class="card-title">Crear Nueva Plantilla</h5>
                    <p class="card-text text-muted">Diseña una nueva guía o procedimiento desde cero.</p>
                    <a href="{{ url_for('plantillas') }}" class="btn btn-primary mt-auto">Comenzar a Crear</a>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Tarjeta para Ver Plantillas -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-card-list" style="font-size: 3rem; color: #198754;"></i></div>
                    <h5 class="card-title">Ver Plantillas Existentes</h5>
                    <p class="card-text text-muted">Consulta las guías y plantillas guardadas.</p>
                    <a href="{{ url_for('ver_plantillas') }}" class="btn btn-success mt-auto">Ver Plantillas</a>
                </div>
            </div>
        </div>

        <!-- Tarjeta Unificada: Herramientas de IA -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm border-info">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-robot" style="font-size: 3rem; color: #0dcaf0;"></i></div>
                    <h5 class="card-title">Herramientas de IA</h5>
                    <p class="card-text text-muted">Asistentes inteligentes para el apoyo clínico.</p>
                    <div class="mt-auto w-100">
                        <a href="{{ url_for('asistente_clinico') }}" class="btn btn-info d-block mb-2">Asistente Clínico</a>
                        {% if session.role == 'administrador' %}
                        <a href="{{ url_for('analizar_guia_page') }}" class="btn btn-outline-info d-block">Analizador de Guías</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta Unificada: Búsqueda -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-search" style="font-size: 3rem; color: #0dcaf0;"></i></div>
                    <h5 class="card-title">Herramientas de Búsqueda</h5>
                    <p class="card-text text-muted">Consulta diagnósticos, procedimientos y más.</p>
                    <div class="mt-auto w-100">
                        <a href="{{ url_for('buscar_diagnosticos') }}" class="btn btn-outline-secondary d-block mb-2">Diagnósticos (CIE-10)</a>
                        <a href="{{ url_for('buscar_procedimientos_page') }}" class="btn btn-outline-secondary d-block mb-2">Procedimientos</a>
                        <a href="{{ url_for('buscar_items') }}" class="btn btn-outline-secondary d-block">Medicamentos/Insumos</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta Unificada: Calculadoras -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-calculator" style="font-size: 3rem; color: #fd7e14;"></i></div>
                    <h5 class="card-title">Calculadoras Clínicas</h5>
                    <p class="card-text text-muted">Herramientas para cálculos rápidos y precisos.</p>
                    <div class="mt-auto w-100">
                        <a href="{{ url_for('calculadora_imc') }}" class="btn btn-warning d-block mb-2">Calculadora de IMC</a>
                        <a href="{{ url_for('calculadora_gestacional') }}" class="btn btn-pink d-block">Calculadora Gestacional</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta Unificada: Guías Rápidas -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-journal-richtext" style="font-size: 3rem; color: #6f42c1;"></i></div>
                    <h5 class="card-title">Guías y Referencias</h5>
                    <p class="card-text text-muted">Consulta datos y tablas de referencia importantes.</p>
                    <div class="mt-auto w-100">
                        <a href="{{ url_for('guia_anemia') }}" class="btn btn-danger d-block mb-2">Guía de Anemia</a>
                        <a href="{{ url_for('guia_peso_talla') }}" class="btn btn-warning d-block mb-2">Guía de Peso y Talla</a>
                        <a href="{{ url_for('referencia_codigos') }}" class="btn btn-purple d-block">Códigos y Fechas</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta para Enviar Sugerencia -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-lightbulb" style="font-size: 3rem; color: #ffc107;"></i></div>
                    <h5 class="card-title">Buzón de Sugerencias</h5>
                    <p class="card-text text-muted">¿Tienes una idea? Ayúdanos a mejorar la aplicación.</p>
                    <a href="{{ url_for('enviar_sugerencia') }}" class="btn btn-warning mt-auto">Enviar Idea</a>
                </div>
            </div>
        </div>

        <!-- Tarjetas de Administración (Solo Admin) -->
        {% if session.role == 'administrador' %}
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-bar-chart-line-fill" style="font-size: 3rem; color: #ffc107;"></i></div>
                    <h5 class="card-title">Dashboard de Métricas</h5>
                    <p class="card-text text-muted">Visualiza las estadísticas de uso de la aplicación.</p>
                    <a href="{{ url_for('dashboard') }}" class="btn btn-warning mt-auto">Ver Dashboard</a>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm border-primary">
                <div class="card-body text-center">
                    <div class="mb-3"><i class="bi bi-shield-lock-fill" style="font-size: 3rem; color: #0d6efd;"></i></div>
                    <h5 class="card-title">Gestión de Seguridad</h5>
                    <p class="card-text text-muted">Administra usuarios, dispositivos y sugerencias.</p>
                    <div class="mt-auto w-100">
                        <a href="{{ url_for('gestionar_usuarios') }}" class="btn btn-primary d-block mb-2">Gestionar Usuarios</a>
                        <a href="{{ url_for('pagina_admin_dispositivos') }}" class="btn btn-primary d-block mb-2 position-relative">
                            Validar Dispositivos
                            {% if solicitudes_pendientes_count > 0 %}
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">{{ solicitudes_pendientes_count }}</span>
                            {% endif %}
                        </a>
                        <a href="{{ url_for('ver_sugerencias') }}" class="btn btn-primary d-block">Ver Sugerencias</a>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}
