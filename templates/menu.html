{% extends "base.html" %}

{% block title %}Menú Principal{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="text-center mb-5">
        <h1>Menú Principal</h1>
        <p class="lead text-muted">Selecciona una opción para comenzar a gestionar las guías y plantillas.</p>
    </div>

    <div class="row justify-content-center g-4">
        
        <!-- Tarjeta para Crear Plantilla -->
        {% if session.role == 'administrador' %}
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-plus-circle-dotted" style="font-size: 3rem; color: #0d6efd;"></i>
                    </div>
                    <h5 class="card-title">Crear Nueva Plantilla</h5>
                    <p class="card-text text-muted flex-grow-1">Diseña una nueva guía o procedimiento desde cero.</p>
                    <a href="{{ url_for('plantillas') }}" class="btn btn-primary mt-auto">Comenzar a Crear</a>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Tarjeta para Ver Plantillas -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-card-list" style="font-size: 3rem; color: #198754;"></i>
                    </div>
                    <h5 class="card-title">Ver Plantillas Existentes</h5>
                    <p class="card-text text-muted flex-grow-1">Consulta las guías y plantillas guardadas.</p>
                    <a href="{{ url_for('ver_plantillas') }}" class="btn btn-success mt-auto">Ver Plantillas</a>
                </div>
            </div>
        </div>
        
        <!-- Tarjeta para la Calculadora de IMC -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-calculator" style="font-size: 3rem; color: #fd7e14;"></i>
                    </div>
                    <h5 class="card-title">Calculadora de IMC</h5>
                    <p class="card-text text-muted flex-grow-1">Calcula el Índice de Masa Corporal de forma rápida.</p>
                    <a href="{{ url_for('calculadora_imc') }}" class="btn btn-warning mt-auto">Abrir Calculadora</a>
                </div>
            </div>
        </div>
        
        <!-- Tarjeta para la Calculadora Gestacional -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                <i class="bi bi-calendar2-heart" style="font-size: 3rem; color: #d63384;"></i>
                    </div>
                    <h5 class="card-title">Calculadora Gestacional</h5>
                    <p class="card-text text-muted flex-grow-1">Calcula la FPP y las semanas de gestación.</p>
                    <a href="{{ url_for('calculadora_gestacional') }}" class="btn btn-pink mt-auto">Abrir Calculadora</a>
                </div>
            </div>
        </div>
        
        <!-- Tarjeta para Códigos y Fechas de Digitación -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-journal-check" style="font-size: 3rem; color: #6f42c1;"></i>
                    </div>
                    <h5 class="card-title">Códigos y Fechas</h5>
                    <p class="card-text text-muted flex-grow-1">Consulta las fechas de digitación y la lista de códigos.</p>
                    <a href="{{ url_for('referencia_codigos') }}" class="btn btn-purple mt-auto">Abrir Referencia</a>
                </div>
            </div>
        </div>
        
        <!-- Tarjeta para Guía de Referencia de Anemia (RC: 61) -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-droplet-half" style="font-size: 3rem; color: #dc3545;"></i>
                    </div>
                    <h5 class="card-title">Guía de Anemia (RC: 61)</h5>
                    <p class="card-text text-muted flex-grow-1">Consulta los valores de referencia para el diagnóstico de anemia.</p>
                    <a href="{{ url_for('guia_anemia') }}" class="btn btn-danger mt-auto">Abrir Guía</a>
                </div>
            </div>
        </div>
        
        <!-- Tarjeta para Guía de Crecimiento (Peso y Talla) -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-rulers" style="font-size: 3rem; color: #ffc107;"></i>
                    </div>
                    <h5 class="card-title">Guía de Peso y Talla</h5>
                    <p class="card-text text-muted flex-grow-1">Consulta los rangos de referencia para el crecimiento infantil y de adultos.</p>
                    <a href="{{ url_for('guia_peso_talla') }}" class="btn btn-warning mt-auto">Consultar</a>
                </div>
            </div>
        </div>

        <!-- Tarjeta para Búsqueda de Diagnósticos (CIE-10) -->
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-search" style="font-size: 3rem; color: #0dcaf0;"></i>
                    </div>
                    <h5 class="card-title">Búsqueda de Diagnósticos</h5>
                    <p class="card-text text-muted flex-grow-1">Busca códigos CIE-10 en la base de datos en tiempo real.</p>
                    <a href="{{ url_for('buscar_diagnosticos') }}" class="btn btn-info mt-auto">Buscar</a>
                </div>
            </div>
        </div>

        <!-- Tarjeta para Gestionar Usuarios (SOLO ADMIN) -->
        {% if session.role == 'administrador' %}
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-person-gear" style="font-size: 3rem; color: #6f42c1;"></i>
                    </div>
                    <h5 class="card-title">Gestionar Usuarios</h5>
                    <p class="card-text text-muted flex-grow-1">Añade, edita o elimina usuarios del sistema.</p>
                    <a href="{{ url_for('gestionar_usuarios') }}" class="btn btn-purple mt-auto">Administrar</a>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Tarjeta para el Dashboard -->
        {% if session.role == 'administrador' %}
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-bar-chart-line-fill" style="font-size: 3rem; color: #ffc107;"></i>
                    </div>
                    <h5 class="card-title">Dashboard de Métricas</h5>
                    <p class="card-text text-muted flex-grow-1">Visualiza las estadísticas de uso de la aplicación.</p>
                    <a href="{{ url_for('dashboard') }}" class="btn btn-warning mt-auto">Ver Dashboard</a>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- ===================================================================== -->
        <!--    NUEVA TARJETA: GESTIONAR DISPOSITIVOS (VALIDAR ACCESO)            -->
        <!-- ===================================================================== -->
        {% if session.role == 'administrador' %}
        <div class="col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm border-danger">
                <div class="card-body text-center d-flex flex-column">
                    <div class="mb-3">
                        <i class="bi bi-shield-lock-fill" style="font-size: 3rem; color: #dc3545;"></i>
                    </div>
                    <h5 class="card-title">Validar Acceso de Dispositivos</h5>
                    <p class="card-text text-muted flex-grow-1">Autoriza o revoca el acceso de los dispositivos de los usuarios.</p>
                    <a href="{{ url_for('pagina_admin_dispositivos') }}" class="btn btn-danger mt-auto">Validar Accesos</a>
                </div>
            </div>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}
